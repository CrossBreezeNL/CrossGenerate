<?xml version="1.0" encoding="UTF-8"?>
<XGenConfig>
  <Model>
    <ModelAttributeInjections>
      <!-- Override the owner attribute with dbo, since it is now filled with the database name. -->
      <ModelAttributeInjection modelXPath="//system[@name='AVS']/mappableObjects/entity" targetAttribute="owner" targetValue="dbo"/>
      <!-- Flip the name and the code column for AVS. -->
      <ModelAttributeInjection modelXPath="//system[@name='AVS']/mappableObjects/entity" targetAttribute="originalName" targetXPath="@id"/>
      <ModelAttributeInjection modelXPath="//system[@name='AVS']/mappableObjects/entity" targetAttribute="id" targetXPath="@name"/>
      <ModelAttributeInjection modelXPath="//system[@name='AVS']/mappableObjects/entity" targetAttribute="name" targetXPath="@originalName"/>
      <ModelAttributeInjection modelXPath="//system[@name='AVS']/mappableObjects/entity/attributes/attribute" targetAttribute="originalName" targetXPath="@id"/>
      <ModelAttributeInjection modelXPath="//system[@name='AVS']/mappableObjects/entity/attributes/attribute" targetAttribute="id" targetXPath="@name"/>
      <ModelAttributeInjection modelXPath="//system[@name='AVS']/mappableObjects/entity/attributes/attribute" targetAttribute="name" targetXPath="@originalName"/>
      <!-- Translate the iSeries datatype into SQL Server datatype. -->
      <ModelAttributeInjection modelXPath="//attribute[lower-case(@datatype)='char']" targetAttribute="fulldatatype" targetXPath="concat('NVAR', @fulldatatype)"/>
    </ModelAttributeInjections>
  </Model>
  <TextTemplate rootSectionName="table">
    <FileFormat currentAccessor="_" childAccessor="$" singleLineCommentPrefix="--" annotationPrefix="@XGen" annotationArgsPrefix="(" annotationArgsSuffix=")" />
    <Output type="output_per_element" />
  </TextTemplate>
  <Binding>
		<SectionModelBinding section="table" modelXPath="/modeldefinition/system/mappableObjects/entity">
			<Placeholders>
				<Placeholder name="system" modelXPath="../.." />
			</Placeholders>
        <SectionModelBinding section="columnNormal" modelXPath="attributes/attribute[not(@length='Max')]" />
        <SectionModelBinding section="columnLargeText" modelXPath="attributes/attribute[@length='Max']" />
        <SectionModelBinding section="keyColumn" modelXPath="attributes/attribute[@primary='true']">
          <SectionModelBinding section="keyRegularColumn" modelXPath=".[not(@datatype='float' or @datatype='real' or @datatype='geometry')]" placeholderName="keyColumn" />
          <SectionModelBinding section="keyFloatColumn" modelXPath=".[@datatype='float' or @datatype='real']" placeholderName="keyColumn" />
          <SectionModelBinding section="keyGeometryColumn" modelXPath=".[@datatype='geometry']" placeholderName="keyColumn" />          
        </SectionModelBinding>
        <SectionModelBinding section="nonKeyColumn" modelXPath="attributes/attribute[not(@primary='true')]">
          <SectionModelBinding section="nonKeyRegularColumn" modelXPath=".[not(@datatype='float' or @datatype='real' or @datatype='geometry')]" placeholderName="nonKeyColumn" />
          <SectionModelBinding section="nonKeyFloatColumn" modelXPath=".[@datatype='float' or @datatype='real']" placeholderName="nonKeyColumn" />
          <SectionModelBinding section="nonKeyGeometryColumn" modelXPath=".[@datatype='geometry']" placeholderName="nonKeyColumn" />
        </SectionModelBinding>
        <!-- Section for part of the template which should be ignored. -->
        <SectionModelBinding section="ignore" modelXPath="attributes/attribute[0=1]" />
		</SectionModelBinding>
  </Binding>
</XGenConfig>